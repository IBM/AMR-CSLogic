from amr_verbnet_semantics.core.amr_verbnet_enhance import ground_amr

sample_ret = {'coreference': [], 'sentence_parses': [{'text': 'The dresser is made out of maple carefully finished with Danish oil.', 'amr': '# ::tok The dresser is made out of maple carefully finished with Danish oil . <ROOT>\n# ::node\t1\tdresser\t1-2\n# ::node\t2\tmake-01\t3-4\n# ::node\t3\tmaple\t6-7\n# ::node\t4\tcareful\t7-8\n# ::node\t5\tfinish-01\t8-9\n# ::node\t6\tcountry\t10-11\n# ::node\t8\toil\t11-12\n# ::node\t9\t"Denmark"\t10-11\n# ::node\t11\tname\t10-11\n# ::root\t2\tmake-01\n# ::edge\tmake-01\tARG1\tdresser\t2\t1\t\n# ::edge\tmake-01\tARG2\tmaple\t2\t3\t\n# ::edge\tfinish-01\tmanner\tcareful\t5\t4\t\n# ::edge\tmaple\tARG1-of\tfinish-01\t3\t5\t\n# ::edge\toil\tmod\tcountry\t8\t6\t\n# ::edge\tfinish-01\tARG2\toil\t5\t8\t\n# ::edge\tcountry\tname\tname\t6\t11\t\n# ::edge\tname\top1\t"Denmark"\t11\t9\t\n# ::short\t{1: \'d\', 2: \'m\', 3: \'m2\', 4: \'c\', 5: \'f\', 6: \'c2\', 8: \'o\', 9: \'x0\', 11: \'n\'}\t\n(m / make-01\n      :ARG1 (d / dresser)\n      :ARG2 (m2 / maple\n            :ARG1-of (f / finish-01\n                  :ARG2 (o / oil\n                        :mod (c2 / country\n                              :name (n / name\n                                    :op1 "Denmark")))\n                  :manner (c / careful))))\n\n', 'pb_vn_mappings': {'make.01': [{'mapping': 'build-26.1-1', 'source': 'verbnet3.4'}], 'finish.01': [{'mapping': 'stop-55.4-1-1', 'source': 'verbnet3.4'}]}, 'role_mappings': {'make.01': {':ARG0': [{'vncls': '26.1-1', 'vntheta': 'agent', 'description': 'creator'}], ':ARG1': [{'vncls': '26.1-1', 'vntheta': 'product', 'description': 'creation'}], ':ARG2': [{'vncls': '26.1-1', 'vntheta': 'material', 'description': 'created-from, thing changed'}], ':ARG3': [{'vncls': '26.1-1', 'vntheta': 'beneficiary', 'description': 'benefactive'}]}, 'finish.01': {':ARG0': [{'vncls': '55.4-1', 'vntheta': 'agent', 'description': 'Intentional agent'}], ':ARG1': [{'vncls': '55.4-1', 'vntheta': 'theme', 'description': 'Thing finishing'}]}}, 'amr_cal': [{'predicate': 'make-01', 'arguments': ['m'], 'is_negative': False}, {'predicate': 'dresser', 'arguments': ['d'], 'is_negative': False}, {'predicate': 'maple', 'arguments': ['m2'], 'is_negative': False}, {'predicate': 'finish-01', 'arguments': ['f'], 'is_negative': False}, {'predicate': 'oil', 'arguments': ['o'], 'is_negative': False}, {'predicate': 'country', 'arguments': ['c2'], 'is_negative': False}, {'predicate': 'name', 'arguments': ['n'], 'is_negative': False}, {'predicate': 'careful', 'arguments': ['c'], 'is_negative': False}, {'predicate': 'make-01.arg1', 'arguments': ['m', 'd'], 'is_negative': False}, {'predicate': 'make-01.arg2', 'arguments': ['m', 'm2'], 'is_negative': False}, {'predicate': 'finish-01.arg1', 'arguments': ['f', 'm2'], 'is_negative': False}, {'predicate': 'finish-01.arg2', 'arguments': ['f', 'o'], 'is_negative': False}, {'predicate': 'mod', 'arguments': ['o', 'c2'], 'is_negative': False}, {'predicate': 'name', 'arguments': ['c2', 'n'], 'is_negative': False}, {'predicate': 'manner', 'arguments': ['f', 'c'], 'is_negative': False}], 'sem_cal': {'make.01': {'build-26.1-1': [{'predicate': 'BE', 'arguments': ['Product', 'e1'], 'is_negative': True}, {'predicate': 'DO', 'arguments': ['e2', 'Agent'], 'is_negative': False}, {'predicate': 'BE', 'arguments': ['e3', 'Product'], 'is_negative': False}, {'predicate': 'MADE_OF', 'arguments': ['e3', 'Product', 'Material'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e3'], 'is_negative': False}, {'predicate': 'COST', 'arguments': ['E', 'Product', 'Asset'], 'is_negative': False}]}, 'finish.01': {'stop-55.4-1-1': [{'predicate': 'DO', 'arguments': ['e1', 'Agent'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e1'], 'is_negative': False}, {'predicate': 'END', 'arguments': ['E', 'Theme'], 'is_negative': False}]}}, 'unique_sem_cal': [{'make.01': [{'predicate': 'BE', 'arguments': ['Product', 'e1'], 'is_negative': True}, {'predicate': 'DO', 'arguments': ['e2', 'Agent'], 'is_negative': False}, {'predicate': 'BE', 'arguments': ['e3', 'Product'], 'is_negative': False}, {'predicate': 'MADE_OF', 'arguments': ['e3', 'Product', 'Material'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e3'], 'is_negative': False}, {'predicate': 'COST', 'arguments': ['E', 'Product', 'Asset'], 'is_negative': False}], 'finish.01': [{'predicate': 'DO', 'arguments': ['e1', 'Agent'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e1'], 'is_negative': False}, {'predicate': 'END', 'arguments': ['E', 'Theme'], 'is_negative': False}]}], 'grounded_stmt': {'make.01': {'build-26.1-1': [[{'predicate': 'BE', 'arguments': ['d', 'e1'], 'is_negative': True}, {'predicate': 'DO', 'arguments': ['e2', 'Agent'], 'is_negative': False}, {'predicate': 'BE', 'arguments': ['e3', 'd'], 'is_negative': False}, {'predicate': 'MADE_OF', 'arguments': ['e3', 'd', 'm2'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e3'], 'is_negative': False}, {'predicate': 'COST', 'arguments': ['E', 'd', 'Asset'], 'is_negative': False}]]}, 'finish.01': {'stop-55.4-1-1': [[{'predicate': 'DO', 'arguments': ['e1', 'Agent'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e1'], 'is_negative': False}, {'predicate': 'END', 'arguments': ['E', 'm2'], 'is_negative': False}]]}}, 'unique_grounded_stmt': [{'make.01': [[{'predicate': 'BE', 'arguments': ['d', 'e1'], 'is_negative': True}, {'predicate': 'DO', 'arguments': ['e2', 'Agent'], 'is_negative': False}, {'predicate': 'BE', 'arguments': ['e3', 'd'], 'is_negative': False}, {'predicate': 'MADE_OF', 'arguments': ['e3', 'd', 'm2'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e3'], 'is_negative': False}, {'predicate': 'COST', 'arguments': ['E', 'd', 'Asset'], 'is_negative': False}]], 'finish.01': [[{'predicate': 'DO', 'arguments': ['e1', 'Agent'], 'is_negative': False}, {'predicate': 'CAUSE', 'arguments': ['e2', 'e1'], 'is_negative': False}, {'predicate': 'END', 'arguments': ['E', 'm2'], 'is_negative': False}]]}], 'amr_cal_str': '[make-01(m), dresser(d), maple(m2), finish-01(f), oil(o), country(c2), name(n), careful(c), make-01.arg1(m, d), make-01.arg2(m, m2), finish-01.arg1(f, m2), finish-01.arg2(f, o), mod(o, c2), name(c2, n), manner(f, c)]', 'sem_cal_str': "{'make.01': {'build-26.1-1': [NOT(BE(Product, e1)), DO(e2, Agent), BE(e3, Product), MADE_OF(e3, Product, Material), CAUSE(e2, e3), COST(E, Product, Asset)]}, 'finish.01': {'stop-55.4-1-1': [DO(e1, Agent), CAUSE(e2, e1), END(E, Theme)]}}", 'unique_sem_cal_str': "[{'make.01': [NOT(BE(Product, e1)), DO(e2, Agent), BE(e3, Product), MADE_OF(e3, Product, Material), CAUSE(e2, e3), COST(E, Product, Asset)], 'finish.01': [DO(e1, Agent), CAUSE(e2, e1), END(E, Theme)]}]", 'grounded_stmt_str': "{'make.01': {'build-26.1-1': [[NOT(BE(d, e1)), DO(e2, Agent), BE(e3, d), MADE_OF(e3, d, m2), CAUSE(e2, e3), COST(E, d, Asset)]]}, 'finish.01': {'stop-55.4-1-1': [[DO(e1, Agent), CAUSE(e2, e1), END(E, m2)]]}}", 'unique_grounded_stmt_str': "[{'make.01': [[NOT(BE(d, e1)), DO(e2, Agent), BE(e3, d), MADE_OF(e3, d, m2), CAUSE(e2, e3), COST(E, d, Asset)]], 'finish.01': [[DO(e1, Agent), CAUSE(e2, e1), END(E, m2)]]}]"}]}


amr = sample_ret['sentence_parses'][0]['amr']
r = ground_amr(amr, verbose=False)
print(r)
print('\ngrounded_stmt_str:', r['grounded_stmt_str'])
print('\nunique_grounded_stmt_str:', r['unique_grounded_stmt_str'])
